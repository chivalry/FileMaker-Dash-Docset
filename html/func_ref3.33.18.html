<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="description" content="Returns the next lower or higher value in sourcefield when there isn’t a matching related value." />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>LookupNext</title>
    <!-- MLP 012913 remove chapter specific css
    <link wwpage:condition="catalog-css" rel="StyleSheet" href="css/catalog.css" wwpage:attribute-href="catalog-css" type="text/css" media="all" />
	 -->
    <link rel="StyleSheet" href="../css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="../css/print.css" type="text/css" media="print" />
    <!--[if lt IE 7]>
     <link rel="StyleSheet" href="../css/ie6.css" type="text/css" media="all" />
    <![endif]-->
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "../";
      // -->
    </script>
  </head>
  <body class="" style="">
    <div id="navbar">
      <a class="navleft" href="../index.html"><span class="navimg">FileMaker Pro 13 Help</span></a>
      <div class="navmarginright"></div>
      <a class="navright" href="toc.html">Contents</a>
      <a class="navright" href="func_ref3.33.19.html"><span>Next</span> &gt;</a>
      <a class="navright" href="func_ref3.33.17.html">&lt; <span>Previous</span></a>
    </div>
    <p id="breadcrumb">
      <a href="../index.html">Home</a> &gt; 
      <a href="part5.html#1028387">Reference</a> &gt; 
      <a href="help_func_cat.29.1.html#1028387">Functions reference</a> &gt; 
      <a href="func_ref3.33.1.html#1028387">Logical functions</a> &gt; 
      <b>LookupNext</b>
    </p>
    <blockquote class="content-fmi">
      <div class="fh-funchead">LookupNext</div>
      <div class="fpuh-funcpurposehead">Purpose<a name="1059791"> </a></div>
      <div class="fpu-funcpurpose"><a name="1059792">Returns the next lower or higher value in </a><span class="c-code">sourcefield </span>when there isn’t a matching related value.</div>
      <div class="ffh-funcformathead">Format<a name="1059793"> </a></div>
      <div class="ff-funcformat"><a name="1059794">LookupNext(sourceField;lower/higherFlag)</a></div>
      <div class="fpah-funcparamhead">Parameters<a name="1028390"> </a></div>
      <div class="b-body"><span class="c-code"><a name="1028393">sourceField</a></span> - the <span class="g-glosslink"><a href="glossary.html#1027703">field</a></span> from which the <span class="g-glosslink"><a href="glossary.html#1027894">lookup</a></span> value is taken</div>
      <div class="b-body"><span class="c-code"><a name="1028394">lower/higherFlag</a></span> - the keywords <span class="c-code">lower</span> or <span class="c-code">higher</span> denote whether the value from the next lower/higher matching <span class="g-glosslink"><a href="glossary.html#1028030">record</a></span> must be taken if no related record is found</div>
      <div class="frh-funcreturnhead">Data type returned<a name="1028396"> </a></div>
      <div class="b-body"><a name="1028397">text, number, date, time, timestamp, container</a></div>
      <div class="orh-originhead">Originated in<a name="1056718"> </a></div>
      <div class="or-origin"><a name="1056719">FileMaker Pro 7.0</a></div>
      <div class="fdh-funcdeschead">Description<a name="1028398"> </a></div>
      <div class="b-body"><a name="1028401">Returns the value specified in </a><span class="c-code">sourceField</span> using the <span class="g-glosslink"><a href="glossary.html#1028048">relationships</a></span> in the <span class="g-glosslink"><a href="glossary.html#1028051">relationships graph</a></span>. LookupNext is similar to <span class="zh-hyper"><a href="func_ref3.33.17.html#1028291">Lookup</a></span>, except that when the lookup fails, the value from <span class="c-code">sourceField</span> in the lower or higher matching record will be returned, as specified by <span class="c-code">lower/higherFlag</span>.</div>
      <div class="b-body"><a name="1059288">For this function to access the value in </a><span class="c-code">sourceField</span>, the <span class="g-glosslink"><a href="glossary.html#1045562">tables</a></span> containing the source field and <span class="g-glosslink"><a href="glossary.html#1027566">calculation field</a></span> need to be related. Calculations using the <span class="c-code">LookupNext</span> function won’t be forced to be <span class="g-glosslink"><a href="glossary.html#1028220">unstored calculations</a></span>.</div>
      <div class="n-note">
        <span class="zan-autonum">Note  </span><span class="c-code"><a name="1028405">LookupNext</a></span> returns <span class="c-code">?</span> when the related table is an ODBC data source.</div>
      <div class="feh-funcexamhead">Examples<a name="1028406"> </a></div>
      <div class="b-body"><a name="1059593">In this example, you are shipping several items and the cost of shipping is based on weight ranges. Use the LookupNext function to find which shipping rate applies for an item. Use </a><span class="c-code">LookupNext</span> with the <span class="c-code">higher</span> flag instead of <span class="c-code">Lookup </span>because the weight of an item may not exactly match the maximum weight, therefore we want to find the <span class="e-emphasis">next</span> highest value.</div>
      <div class="b-body"><a name="1059495">There are two tables, Items and Shipping Costs, in a database file containing data as shown below. </a></div>
      <div class="b-body"><span class="e-emphasis"><a name="1028409">Items table</a></span></div>
      <div class="ta-tableanchor"><a name="1028431"> </a></div>
      <table class="t-table" style="text-align: left;" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059697">Item</a></div>
          </td>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059699">Weight</a></div>
          </td>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059701">Rate Lookup</a></div>
          </td>
        </tr>
        <tr>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059703">Lamp</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059705">8</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059707"> </a></div>
          </td>
        </tr>
        <tr>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059709">Chair</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059711">22</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059713"> </a></div>
          </td>
        </tr>
        <tr>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059715">Desk</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059717">60</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059719"> </a></div>
          </td>
        </tr>
        <tr>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059721">Bed</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059723">120</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059725"> </a></div>
          </td>
        </tr>
      </table>
      <div class="b-body"><span class="e-emphasis"><a name="1028432">Shipping Costs table</a></span></div>
      <div class="ta-tableanchor"><a name="1059449"> </a></div>
      <table class="t-table" style="text-align: left;" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059513">Rate Code</a></div>
          </td>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059515">Maximum Weight</a></div>
          </td>
        </tr>
        <tr>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059517">A</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059519">25</a></div>
          </td>
        </tr>
        <tr>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059521">B</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059523">50</a></div>
          </td>
        </tr>
        <tr>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059525">C</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059527">100</a></div>
          </td>
        </tr>
        <tr>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059529">D</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059531">150</a></div>
          </td>
        </tr>
      </table>
      <div class="b-body"><a name="1059450">The two tables are related by </a><span class="c-code">Weight </span>and <span class="c-code">Max Weight</span>. The calculation field <span class="c-code">Rate Lookup </span>is defined as <span class="c-code">Rate Lookup = LookupNext(Shipping Costs::Max Weight; Higher)</span>. </div>
      <div class="b-body"><a name="1059569">The </a><span class="c-code">Rate Lookup </span>calculation field will return <span class="o-onscreen">25</span>, <span class="o-onscreen">25</span>, <span class="o-onscreen">100</span>, and <span class="o-onscreen">150 </span>for records 1 to 4. <span class="c-code">Rate Lookup </span>can then be used to get the correct rate code (A, A, C, and D respectively).</div>
      <div class="ta-tableanchor"><a name="1059682"> </a></div>
      <table class="t-table" style="text-align: left;" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059732">Item</a></div>
          </td>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059734">Weight</a></div>
          </td>
          <td style="background-color: #666666; background-image: url(&quot;images\tablebg.gif&quot;); background-repeat: repeat-x; padding-left: .4em; padding-right: .4em; vertical-align: bottom;">
            <div class="th-tablehead"><a name="1059736">Rate Lookup</a></div>
          </td>
        </tr>
        <tr>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059738">Lamp</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059740">8</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059742">25</a></div>
          </td>
        </tr>
        <tr>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059744">Chair</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059746">22</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059748">25</a></div>
          </td>
        </tr>
        <tr>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059750">Desk</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059752">60</a></div>
          </td>
          <td style="padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059754">100</a></div>
          </td>
        </tr>
        <tr>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059756">Bed</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059758">120</a></div>
          </td>
          <td style="background-color: #E6EDFF; padding-left: .4em; padding-right: .4em; vertical-align: top;">
            <div class="td-tabledata"><a name="1059760">150</a></div>
          </td>
        </tr>
      </table>
      <div class="rh-relatedhead">Related topics<a name="1028472"> </a></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="help_func_cat.29.2.html#707904" name="1028476">Functions reference (category list)</a></span></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="help_func_alpha.html#47874" name="1028480">Functions reference (alphabetical list)</a></span></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="create_db.8.46.html#1030710" name="1028484">About formulas</a></span></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="create_db.8.45.html#1030581" name="1028488">About functions</a></span></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="create_db.8.20.html#1029046" name="1028492">Defining calculation fields</a></span></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="create_db.8.47.html#1030789" name="1028496">Using operators in formulas</a></span></div>
    </blockquote>
    <div class="feedbacklink">Was this topic helpful? <a href="http://www.filemaker.com/redirects/fmp13_admin.html?page=feedback&amp;lang=en" target="external_window">Send feedback.</a></div>
  </body>
</html>