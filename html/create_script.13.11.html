<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="description" content="The type library describes the objects, properties, and methods exposed by FileMaker Pro, so that other ActiveX clients can access FileMaker Pro." />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Using FileMaker Pro ActiveX Automation (Windows)</title>
    <!-- MLP 012913 remove chapter specific css
    <link wwpage:condition="catalog-css" rel="StyleSheet" href="css/catalog.css" wwpage:attribute-href="catalog-css" type="text/css" media="all" />
	 -->
    <link rel="StyleSheet" href="../css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="../css/print.css" type="text/css" media="print" />
    <!--[if lt IE 7]>
     <link rel="StyleSheet" href="../css/ie6.css" type="text/css" media="all" />
    <![endif]-->
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "../";
      // -->
    </script>
  </head>
  <body class="" style="">
    <div id="navbar">
      <a class="navleft" href="../index.html"><span class="navimg">FileMaker Pro 13 Help</span></a>
      <div class="navmarginright"></div>
      <a class="navright" href="toc.html">Contents</a>
      <a class="navright" href="create_script.13.12.html"><span>Next</span> &gt;</a>
      <a class="navright" href="create_script.13.10.html">&lt; <span>Previous</span></a>
    </div>
    <p id="breadcrumb">
      <a href="../index.html">Home</a> &gt; 
      <a href="part2.html#1028245">Designing and creating databases</a> &gt; 
      <a href="create_script.13.1.html#1028245">Creating scripts to automate tasks</a> &gt; 
      <a href="create_script.13.10.html#1028245">Scripting with ActiveX Automation (Windows)</a> &gt; 
      <b>Using FileMaker Pro ActiveX Automation (Windows)</b>
    </p>
    <blockquote class="content-fmi">
      <div class="h4-head4">Using FileMaker Pro ActiveX Automation (Windows)</div>
      <div class="hs1-headsub1"><a name="1028251">The FileMaker Pro Type Library </a></div>
      <div class="b-body"><a name="1028252">The type library describes the objects, properties, and methods exposed by FileMaker Pro, so that other ActiveX clients can access FileMaker Pro.</a></div>
      <div class="b-body"><a name="1028253">The FileMaker Pro Type Library is included in the FileMaker Pro executable. It is not a separate file. The FileMaker Pro Type Library was registered on your computer when you installed FileMaker Pro.</a></div>
      <div class="b-body"><a name="1028254">In Visual Basic, add "FileMaker Pro Type Library" to the list of Available References in your project.</a></div>
      <div class="ni-noteimportant">
        <span class="zan-autonum">Important  </span><a name="1028255">You must add the FileMaker Pro Type Library to the list of available type libraries in the application you will be using to implement your ActiveX Automation document. If you don't add the type library, you won't be able to address FileMaker Pro via ActiveX Automation.</a></div>
      <div class="b-body"><a name="1028256">The method for adding this library varies in the different ActiveX Automation authoring tools. Consult the manual that came with your ActiveX Automation authoring tool if you are unsure of how to do this. The following procedure explains how to do this in Microsoft Visual Basic.</a></div>
      <div class="hs1-headsub1"><a name="1028257">To add the FileMaker Pro Type Library to Microsoft Visual Basic:</a></div>
      <div class="s1f-step1first_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="s1f-step1first_inner" style="width: 1.5em; white-space: nowrap;">
                <span class="zan-autonum">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="s1f-step1first_inner"><a name="1028258">In Microsoft Visual Basic, choose </a><span class="o-onscreen">Project</span> menu &gt; <span class="o-onscreen">References</span> &gt; <span class="o-onscreen">Add Type Library</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="s1r-step1reg_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="s1r-step1reg_inner" style="width: 1.5em; white-space: nowrap;">
                <span class="zan-autonum">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="s1r-step1reg_inner"><a name="1028259">Enable the checkbox to the left of the </a><span class="o-onscreen">FileMaker Pro Type Library</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="s1r-step1reg_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="s1r-step1reg_inner" style="width: 1.5em; white-space: nowrap;">
                <span class="zan-autonum">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="s1r-step1reg_inner"><a name="1028260">Click </a><span class="o-onscreen">OK</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="b-body"><span class="o-onscreen"><a name="1028261">FMPro70Lib</a></span> appears in the Visual Basic Object Browser once the project references include the FileMaker Pro Type Library. All of the objects, methods and properties that FileMaker Pro exposes for Automation control are now available.</div>
      <div class="hs1-headsub1"><a name="1028262">Declaring FileMaker Pro as the Application object</a></div>
      <div class="b-body"><a name="1028263">Declare the FileMaker Pro as the Application object each time you create an ActiveX Automation script or application to control FileMaker Pro. This can be done with a single line of code at the top of your Automation document, where it appears with your other definitions.</a></div>
      <div class="b-body"><a name="1028264">For example:</a></div>
      <div class="co-code"><a name="1028265">	Dim FMProApp As FMPro70Lib.Application</a></div>
      <div class="hs1-headsub1"><a name="1028266">Getting an Application object</a></div>
      <div class="b-body"><a name="1028267">To make any Automation calls to FileMaker, you must first get access to the FileMaker Application Object. There are two ways to do so: by calling CreateObject, or by calling GetObject.</a></div>
      <div class="b-body"><a name="1028268">To use either call, first declare the Application object:</a></div>
      <div class="co-code"><a name="1028269">	Dim FMProApp as FMPro70Lib.Application</a></div>
      <div class="b-body"><a name="1028270">For CreateObject only:</a></div>
      <div class="co-code"><a name="1028271">	Set FMProApp = CreateObject("FMPRO.Application")</a></div>
      <div class="b-body"><a name="1028272">CreateObject will launch FileMaker if it is not already running.</a></div>
      <div class="b-body"><a name="1028273">The GetObject function retrieves an Application object only if FileMaker is already running.</a></div>
      <div class="b-body"><a name="1028274">For GetObject only:</a></div>
      <div class="co-code"><a name="1028275">	Set FMProApp = GetObject(, "FMPRO.Application")</a></div>
      <div class="b-body"><a name="1028276">Notice the comma, which indicates that the first argument to GetObject — a path to a disk file — has been omitted. The comma is required because under some circumstances GetObject takes a filename as its first argument. To retrieve an instance of FileMaker, however, you must omit the filename argument, or an error will occur.</a></div>
      <div class="hs1-headsub1"><a name="1028277">Calling a FileMaker Pro script</a></div>
      <div class="b-body"><a name="1028278">To run a FileMaker Pro script via ActiveX Automation, call the DoFMScript function with the name of the script as the variable.</a></div>
      <div class="b-body"><a name="1028279">For example:</a></div>
      <div class="co-code"><a name="1028280">	Dim FMProApp as FMPro70Lib.Application<br />	CreateObject("FMPRO.application")<br />	Dim FMProDocs, FMProDocs.Open("c:\MyFile.fmp12","","")<br />	Dim FMProDoc<br />	FMProDoc.DoFMScript ("MyScript")<br />	Set FMProDoc = nothing</a></div>
      <div class="hs1-headsub1"><a name="1028281">Toggling the visibility of the FileMaker Pro application</a></div>
      <div class="b-body"><a name="1028282">When FileMaker Pro is launched by Automation, it will run hidden by default. You can use the visible property to hide or show FileMaker Pro.</a></div>
      <div class="b-body"><a name="1028283">For example, to hide the application:</a></div>
      <div class="co-code"><a name="1046150">	FMProApp.Visible = False</a></div>
      <div class="b-body"><a name="1046151">To show the application:</a></div>
      <div class="co-code"><a name="1046152">	FMProApp.Visible = True</a></div>
      <div class="hs1-headsub1"><a name="1028287">Reference counts and releasing an object</a></div>
      <div class="b-body"><a name="1028288">When an automation object is referenced, a reference count increments to let FileMaker know that a process is using that object. In Visual Basic, an object is reference counted every time you set the declared variable to a FileMaker object, for example:</a></div>
      <div class="co-code"><a name="1028289">' just a declaration - no references yet</a></div>
      <div class="co-code"><a name="1028290">	Dim FMDocs as FMPro70Lib.Documents </a></div>
      <div class="co-code"><a name="1028291">' this line causes a reference of FileMaker's "Documents" object</a></div>
      <div class="co-code"><a name="1028292">	Set FMDocs = FMApp.Documents </a></div>
      <div class="co-code"><a name="1028293">' this causes a second reference of the same FileMaker "Documents" object</a></div>
      <div class="co-code"><a name="1028294">	Set FMDocs2 = FMApp.Documents </a></div>
      <div class="b-body"><a name="1028295">FileMaker may not exit until all reference counts are released. In Visual Basic, you can release the reference count by setting the object variable to "Nothing", for example:</a></div>
      <div class="co-code"><a name="1028296">' releases the reference to the FileMaker "Documents" object</a></div>
      <div class="co-code"><a name="1028297">	Set FMDocs = Nothing </a></div>
      <div class="co-code"><a name="1028298">' releases the 2nd reference to the FileMaker "Documents" object</a></div>
      <div class="co-code"><a name="1028299">	Set FMDocs2 = Nothing </a></div>
      <div class="co-code"><a name="1028300">' releases the reference to the FileMaker Application object</a></div>
      <div class="co-code"><a name="1028301">	Set FMApp = Nothing </a></div>
      <div class="b-body"><a name="1028302">It is good practice to always set object variables to "Nothing" when you have finished using the variables.</a></div>
      <div class="hs1-headsub1"><a name="1028303">Access Privileges</a></div>
      <div class="b-body"><a name="1028304">FileMaker Pro uses the </a><span class="c-code">Documents.Open(filename As String, accountName As String, password As String</span>) method. If the <span class="c-code">accountName</span> and <span class="c-code">password</span> arguments are empty strings, the file will be opened as a client user.</div>
      <div class="hs1-headsub1"><a name="1028305">Scripts</a></div>
      <div class="b-body"><a name="1028306">FileMaker Pro scripts called directly by Automation may interrupt each other.</a></div>
      <div class="b-body"><a name="1028307">FileMaker Pro scripts called from within other FileMaker Pro scripts will run in order, as expected.</a></div>
      <div class="hs1-headsub1"><a name="1028308">Remotely hosted files</a></div>
      <div class="b-body"><a name="1028309">It is not possible to open a hosted file using ActiveX Automation alone. To open a hosted file using Automation, you can either open the hosted file directly using the FileMaker Open dialog box, and then access the file using Automation, or you can write a FileMaker Pro script that opens the hosted file, and then call that script via Automation.</a></div>
      <div class="rh-relatedhead">Related topics<a name="1028310"> </a></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="#1028245" name="1028314">Using FileMaker Pro ActiveX Automation (Windows)</a></span></div>
      <div class="rt-relatedtopic"><span class="zh-hyper"><a href="create_script.13.13.html#1028380" name="1028318">ActiveX Automation example (Windows)</a></span></div>
    </blockquote>
    <div class="feedbacklink">Was this topic helpful? <a href="http://www.filemaker.com/redirects/fmp13_admin.html?page=feedback&amp;lang=en" target="external_window">Send feedback.</a></div>
  </body>
</html>