<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="description" content="The more time you spend planning your script, the more likely that it will accomplish what you want. As you plan, ask yourself these questions:" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Planning a script</title>
    <!-- MLP 012913 remove chapter specific css
    <link wwpage:condition="catalog-css" rel="StyleSheet" href="css/catalog.css" wwpage:attribute-href="catalog-css" type="text/css" media="all" />
	 -->
    <link rel="StyleSheet" href="../css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="../css/print.css" type="text/css" media="print" />
    <!--[if lt IE 7]>
     <link rel="StyleSheet" href="../css/ie6.css" type="text/css" media="all" />
    <![endif]-->
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "../";
      // -->
    </script>
  </head>
  <body class="" style="">
    <div id="navbar">
      <a class="navleft" href="../index.html"><span class="navimg">FileMaker Pro 13 Help</span></a>
      <div class="navmarginright"></div>
      <a class="navright" href="toc.html">Contents</a>
      <a class="navright" href="create_script.13.3.html"><span>Next</span> &gt;</a>
      <a class="navright" href="create_script.13.1.html">&lt; <span>Previous</span></a>
    </div>
    <p id="breadcrumb">
      <a href="../index.html">Home</a> &gt; 
      <a href="part2.html#1027607">Designing and creating databases</a> &gt; 
      <a href="create_script.13.1.html#1027607">Creating scripts to automate tasks</a> &gt; 
      <b>Planning a script</b>
    </p>
    <blockquote class="content-fmi">
      <div class="h3-head3">Planning a script</div>
      <div class="b-body"><a name="1027609">The more time you spend planning your </a><span class="g-glosslink"><a href="glossary.html#1028072">script</a></span>, the more likely that it will accomplish what you want. As you plan, ask yourself these questions:</div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027611">Can you separate the task into smaller tasks? You can define </a><span class="g-glosslink"><a href="glossary.html#1028145">sub-scripts</a></span> for each small task, and then define a script that performs the sub-scripts. It's easier to design and test several small scripts than one complex one. You can also reuse sub-scripts in other areas. (Use <span class="zh-hyper"><a href="scripts_ref1.36.2.html#1051802">Perform Script script step</a></span> to perform a sub-script inside another script.)</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027616">What </a><span class="g-glosslink"><a href="glossary.html#1028078">script steps</a></span> should be executed under what conditions? Should every script step always be executed? Should some be executed a number of times until a certain condition is met? Should the script call other scripts and sub-scripts? You can control the progression of the script in a number of different ways. See <span class="zh-hyper"><a href="scripts_ref1.36.1.html#1100100">Control script steps</a></span> for more information on creating scripts with conditional steps.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1046443">Do you want the script to run in a particular </a><span class="g-glosslink"><a href="glossary.html#1027851">layout</a></span>? Because scripts are defined at the file level and can be called from any layout, you should make sure the script will operate in the layout or layouts you expect. Use the <span class="zh-hyper"><a href="scripts_ref1.36.20.html#1028245">Go to Layout script step</a></span> to change layouts.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1046404">Should the script work on all records in the database, the current found set, or a specific set of records? (Use the </a><span class="zh-hyper"><a href="scripts_ref1.36.78.html#1048578">Found Sets script steps</a></span> to include only the records that you want to work with in the found set.)</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1046359">Is all the data you need in one </a><span class="g-glosslink"><a href="glossary.html#1027641">database file</a></span>, or will the script operate on more than one file? If you're using multiple files, which ones should the script open? In which file should the script(s) be defined? In most cases a script should be defined in the same file as the data it is processing. Database solutions with more than one file may need separate scripts in each file, depending on the complexity of the task you are trying to script.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027636">With which </a><span class="g-glosslink"><a href="glossary.html#1028030">record</a></span> should the script start? For example, when using the <span class="zh-hyper"><a href="scripts_ref1.36.11.html#1027932">Loop script step</a></span>, you must decide whether the loop starts at the first or last record, a specific record, or the current record in the <span class="g-glosslink"><a href="glossary.html#1027747">found set</a></span>. (Use the <span class="zh-hyper"><a href="scripts_ref1.36.21.html#1028306">Go to Record/Request/Page script step</a></span>, <span class="zh-hyper"><a href="scripts_ref1.36.22.html#1028356">Go to Related Record script step</a></span>, or <span class="zh-hyper"><a href="scripts_ref1.36.23.html#1028409">Go to Portal Row script step</a></span> to specify a starting record. If you don't include a navigation script step to determine the current record, the loop begins with the record that's current when the script is performed.) </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1034308">Which window do you want to use? A script is initially attached to a specific window, which may be in the background. The script remains on that window until a scripted action switches to another window. For example, use the </a><span class="zh-hyper"><a href="scripts_ref2.37.3.html#1027618">Select Window script step</a></span> to specify a different window. If the specified window is not available, the script switches to the foreground window of the file. When you pause a script, the associated window becomes the foreground window if it is available.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027649">Should the script switch among </a><span class="g-glosslink"><a href="glossary.html#1027931">modes</a></span>? A script can be run from Browse, Find, Layout, or Preview modes. Make sure your script is in the proper mode before it acts upon something. For example, use the <span class="zh-hyper"><a href="scripts_ref1.36.29.html#1028589">Enter Browse Mode script step</a></span> to modify data in fields and records, and use the <span class="zh-hyper"><a href="scripts_ref1.36.30.html#1028614">Enter Find Mode script step</a></span> to set up or perform a <span class="g-glosslink"><a href="glossary.html#1027732">find request</a></span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="n1-note1">
        <span class="zan-autonum">Note  </span><a name="1027657">Scripts performed in Layout mode automatically switch to Browse mode before executing.</a></div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027660">Which </a><span class="g-glosslink"><a href="glossary.html#1027703">fields</a></span> and layouts will the script need? Some steps (such as the <span class="zh-hyper"><a href="scripts_ref1.36.25.html#1028490">Go to Field script step</a></span> and the <span class="zh-hyper"><a href="scripts_ref1.36.45.html#1096105">Insert Text script step</a></span>) require a field to be on the current layout, while others (such as the <span class="zh-hyper"><a href="scripts_ref1.36.42.html#1029024">Set Field script step</a></span>) don’t. Either use the <span class="zh-hyper"><a href="scripts_ref1.36.20.html#1028245">Go to Layout script step</a></span> to switch to a layout that has the fields your script requires, or place the fields on the gray area to the right of the layout to make the fields available for script steps but not to users.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027699">Should the records be processed in a certain order? Decide among the current </a><span class="g-glosslink"><a href="glossary.html#1028117">sort order</a></span>, a specified sort order, or unsorted (the order in which the records were created). Use the <span class="zh-hyper"><a href="scripts_ref1.36.89.html#1030639">Sort Records script step</a></span> or the <span class="zh-hyper"><a href="scripts_ref1.36.90.html#1053858">Unsort Records script step</a></span> before entering a loop to order your records properly before processing them.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027708">How should the script advance through multiple fields or records? (Use the </a><span class="zh-hyper"><a href="scripts_ref1.36.21.html#1028306">Go to Record/Request/Page script step</a></span>, the <span class="zh-hyper"><a href="scripts_ref1.36.11.html#1027932">Loop script step</a></span>, the <span class="zh-hyper"><a href="scripts_ref1.36.12.html#1096168">Exit Loop If script step</a></span> and the <span class="zh-hyper"><a href="scripts_ref1.36.13.html#1028031">End Loop script step</a></span> to control multiple field or record processing).</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027719">When should the script finish? After all script steps have run? After a specified condition has been met? (Use the </a><span class="zh-hyper"><a href="scripts_ref1.36.7.html#1096189">If script step</a></span>, the <span class="zh-hyper"><a href="scripts_ref1.36.8.html#1027828">Else If script step</a></span>, and the <span class="zh-hyper"><a href="scripts_ref1.36.9.html#1027875">Else script step</a></span> to perform a task such as the <span class="zh-hyper"><a href="scripts_ref1.36.5.html#1027697">Exit Script script step</a></span> when the script reaches a specified condition.)</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027732">How will you test your script? Use the </a><span class="zh-hyper"><a href="scripts_ref1.36.4.html#1096244">Pause/Resume Script script step</a></span> to pause at predefined points in your script. Save a copy of your database, and then define and test your script in it to preserve the original data.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="n1-note1">
        <span class="zan-autonum">Note  </span><a name="1046295">If you are using FileMaker Pro Advanced, you can use the Script Debugger to test and troubleshoot your scripts.</a></div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027734">How will you handle error conditions (such as an empty found set)? You can capture the last error condition reported by FileMaker Pro by using the </a><span class="zh-hyper"><a href="func_ref2.32.46.html#1029752">Get(LastError) function</a></span>. Use this function and the <span class="zh-hyper"><a href="scripts_ref1.36.7.html#1096189">If script step</a></span>, the <span class="zh-hyper"><a href="scripts_ref1.36.8.html#1027828">Else If script step</a></span>, and the <span class="zh-hyper"><a href="scripts_ref1.36.9.html#1027875">Else script step</a></span> to create scripts that react gracefully to user errors or unexpected results. For even greater control, use the <span class="zh-hyper"><a href="scripts_ref1.36.15.html#1028105">Set Error Capture script step</a></span> to suppress the error alerts that FileMaker Pro normally displays in these situations, and replace them with your own using the <span class="zh-hyper"><a href="scripts_ref2.37.60.html#1068697">Show Custom Dialog script step</a></span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027754">Should all users be allowed to perform all scripts? Use </a><span class="g-glosslink"><a href="glossary.html#1028013">privilege sets</a></span> to control users’ access to scripting. Through the use of privilege sets, users can be allowed to execute or modify individual scripts, no scripts, or all scripts. You can also set the default permission for each privileges set for any future new scripts that are defined in the file. Setting a script to run with full access privileges will allow the script to do things on behalf of the user that may not be normally allowed by their assigned privileges. See <span class="zh-hyper"><a href="passwords.14.15.html#1028334">Creating and managing privilege sets</a></span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bu1-bullet1_outer" style="margin-left: 0em;">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="bu1-bullet1_inner" style="width: 1.5em; white-space: nowrap;">
                <span style="color: Black; font-weight: bold;"> •</span>
              </div>
            </td>
            <td width="100%">
              <div class="bu1-bullet1_inner"><a name="1027759">How will users perform the script? You either need to create a </a><span class="g-glosslink"><a href="glossary.html#1027559">button</a></span> to perform the script or specify that the script be added to the Scripts menu. Scripts can also be run from the Manage Scripts dialog box or when a <span class="g-glosslink"><a href="glossary.html#1033294">script trigger</a></span> is activated. For example, you can use the <span class="zh-hyper"><a href="script_trigg.38.20.html#1033390">OnFirstWindowOpen</a></span> script trigger to run a script when the database opens.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="b-body"><a name="1027763">Once you've considered these questions, you're ready to manage scripts in your database. See </a><span class="zh-hyper"><a href="create_script.13.3.html#1037007">Creating and editing scripts</a></span>. </div>
    </blockquote>
    <div class="feedbacklink">Was this topic helpful? <a href="http://www.filemaker.com/redirects/fmp13_admin.html?page=feedback&amp;lang=en" target="external_window">Send feedback.</a></div>
  </body>
</html>